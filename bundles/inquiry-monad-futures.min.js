!function(i,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("Future")):"function"==typeof define&&define.amd?define("InquiryMonadFutures",["Future"],n):"object"==typeof exports?exports.InquiryMonadFutures=n(require("Future")):i.InquiryMonadFutures=n(i.Future)}(window,function(i){return function(i){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return i[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=i,a.c=n,a.d=function(i,n,s){a.o(i,n)||Object.defineProperty(i,n,{configurable:!1,enumerable:!0,get:s})},a.r=function(i){Object.defineProperty(i,"__esModule",{value:!0})},a.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(n,"a",n),n},a.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},a.p="",a(a.s=3)}([function(i,n){const a=i=>({isJust:!0,isNothing:!1,inspect:n=>`Just(${i})`,map:n=>o.of(n(i)),ap:n=>n.map(i),chain:n=>n(i),join:n=>i,fork:(n,a)=>a(i),sequence:n=>i.map(o.of)}),s=i=>({isJust:!1,isNothing:!0,inspect:i=>"Nothing",map:i=>s(),ap:i=>s(),chain:i=>s(),join:i=>s(),fork:(i,n)=>i(),sequence:i=>i(s())}),o={of:i=>null===i||void 0===i?s():a(i)};i.exports={Maybe:o,Nothing:s,Just:a}},function(i,n,a){"use strict";var s=this&&this.__awaiter||function(i,n,a,s){return new(a||(a=Promise))(function(o,t){function e(i){try{u(s.next(i))}catch(i){t(i)}}function r(i){try{u(s.throw(i))}catch(i){t(i)}}function u(i){i.done?o(i.value):new a(function(n){n(i.value)}).then(e,r)}u((s=s.apply(i,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const o=a(0),t=i=>({map:n=>t(n(i)),chain:n=>n(i),ap:n=>n.map(i),inspect:()=>`IOU(${i})`,join:()=>i,concat:n=>n.chain(n=>t(i.concat(n))),head:()=>Array.isArray(i)&&i.length?i[0]:[],tail:()=>Array.isArray(i)&&i.length?i[i.length-1]:[],isEmpty:()=>Boolean(!Array.isArray(i)||0===i.length),isInquiry:!1,isPass:!1,isFail:!1,isIOU:!0});n.IOU=t;const e=i=>({map:n=>e(n(i)),chain:n=>n(i),fold:(n,a)=>n(i),fork:(n,a)=>a(i),head:()=>Array.isArray(i)&&i.length?i[0]:[],tail:()=>Array.isArray(i)&&i.length?i[i.length-1]:[],join:()=>i,inspect:()=>`Pass(${i})`,concat:n=>n.fold(n=>e(i.concat(n)),null),ap:n=>n.isPass?n.concat(e(i)):e(i),answer:(n,a="(anonymous)",s=c)=>(n.informant([a,e(i)]),s({subject:n.subject,fail:n.fail,iou:n.iou,pass:n.pass.concat(e(i)),informant:n.informant})),isEmpty:()=>Boolean(!Array.isArray(i)||0===i.length),isPass:!0,isFail:!1,isIOU:!1,isInquiry:!1});n.Pass=e;const r=i=>({map:n=>r(n(i)),chain:n=>n(i),fold:(n,a)=>a(i),fork:(n,a)=>n(i),head:()=>Array.isArray(i)&&i.length?i[0]:[],tail:()=>Array.isArray(i)&&i.length?i[i.length-1]:[],join:()=>i,inspect:()=>`Fail(${i})`,concat:n=>n.fork(n=>r(i.concat(n)),null),ap:n=>n.isPass?r(i):n.concat(r(i)),answer:(n,a="(anonymous)",s=c)=>(n.informant([a,r(i)]),s({subject:n.subject,fail:n.fail.concat(r(i)),pass:n.pass,iou:n.iou,informant:n.informant})),isEmpty:()=>Boolean(!Array.isArray(i)||0===i.length),isPass:!1,isFail:!0,isIOU:!1,isInquiry:!1});n.Fail=r;const u=i=>i.isInquiry?i:c({subject:o.Maybe.of(i),fail:r([]),pass:e([]),iou:t([]),informant:i=>i}),c=i=>({inquire:n=>{const a=n(i.subject.join());return a.isFail||a.isPass||a.isInquiry?a.answer(i,n.name,c):e(a)},informant:n=>c({subject:i.subject,iou:i.iou,fail:i.fail,pass:i.pass,informant:n}),inspect:()=>`Inquiry(${i.fail.inspect()} ${i.pass.inspect()} ${i.iou.inspect()}`,swap:()=>c({subject:i.subject,iou:i.iou,fail:r(i.pass.join()),pass:e(i.fail.join()),informant:i.informant}),unison:n=>c({subject:i.subject,iou:i.iou,fail:r(n(i.fail.join())),pass:e(n(i.pass.join())),informant:i.informant}),map:n=>u(n(i)),ap:n=>n.map(i),chain:n=>n(i),join:()=>i,breakpoint:n=>i.fail.join().length?n(i):c(i),milestone:n=>i.pass.join().length?n(i):c(i),answer:(n,a,s)=>(n.informant([a,c(i)]),c({subject:n.subject,iou:n.iou,fail:n.fail.concat(i.fail),pass:n.pass.concat(i.pass),informant:n.informant})),conclude:(n,a)=>({subject:i.subject,iou:i.iou,fail:n(i.fail),pass:a(i.pass),informant:i.informant}),cleared:n=>i.fail.isEmpty()?n(i.pass):c(i),faulted:n=>i.fail.isEmpty()?c(i):n(i.fail),fork:(n,a)=>i.fail.join().length?n(i.fail):a(i.pass),zip:n=>n(i.fail.join().concat(i.pass.join())),isInquiry:!0}),l={subject:u,of:i=>c(i)};n.Inquiry=l;const f=i=>i.isInquiry?i:m({subject:o.Maybe.of(i),fail:r([]),pass:e([]),iou:t([]),informant:i=>i}),p=i=>m(i),j=i=>n=>n.reduce((n,a)=>a.answer(i,"reduced",m),i),m=i=>({inquire:n=>{const a=n(i.subject.join());return a.then?m({subject:i.subject,fail:i.fail,pass:i.pass,iou:i.iou.concat(t([a])),informant:i.informant}):(a=>a.isFail||a.isPass||a.isInquiry?a.answer(i,n.name,m):e(a))(a)},informant:n=>m({subject:i.subject,iou:i.iou,fail:i.fail,pass:i.pass,informant:n}),inspect:()=>`InquiryP(${i.fail.inspect()} ${i.pass.inspect()} ${i.iou.inspect()}`,swap:()=>m({subject:i.subject,iou:i.iou,fail:r(i.pass.join()),pass:e(i.fail.join()),informant:i.informant}),unison:n=>m({subject:i.subject,iou:i.iou,fail:r(n(i.fail.join())),pass:e(n(i.pass.join())),informant:i.informant}),map:n=>f(n(i)),ap:n=>n.map(i),chain:n=>n(i),join:()=>i,breakpoint:n=>i.fail.join().length?n(i):m(i),milestone:n=>i.pass.join().length?n(i):m(i),answer:(n,a,s)=>(n.informant([a,m(i)]),m({subject:n.subject,iou:n.iou,fail:n.fail.concat(i.fail),pass:n.pass.concat(i.pass),informant:n.informant})),conclude:(n,a)=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>({subject:i.subject,iou:i.iou,fail:n(i.fail),pass:a(i.pass),informant:i.informant}))}),cleared:n=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>i.fail.isEmpty()?n(i.pass):m(i)).catch(i=>console.error("err",i))}),faulted:n=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>i.fail.isEmpty()?m(i):n(i.fail))}),fork:(n,a)=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>i.fail.join().length?n(i.fail):a(i.pass))}),zip:n=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>n(i.fail.join().concat(i.pass.join())))}),await:()=>s(this,void 0,void 0,function*(){return Promise.all(i.iou.join()).then(j(i)).then(i=>i.isInquiry?i.join():i).then(i=>p(i))}),isInquiry:!0}),y={subject:f,of:p};n.InquiryP=y},function(n,a){n.exports=i},function(i,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const s=a(0),o=a(2);n.Future=o.Future;const t=a(1);n.Pass=t.Pass,n.Fail=t.Fail,n.IOU=t.IOU;const e=i=>n=>n.reduce((n,a)=>a.answer(i,"reduced",c),i),r=i=>"isInquiry"in i?i:c({subject:s.Maybe.of(i),fail:t.Fail([]),pass:t.Pass([]),iou:t.IOU([]),informant:i=>i}),u=i=>c(i),c=i=>({inquire:n=>{const a=n(i.subject.join());return a instanceof o.Future?c({subject:i.subject,fail:i.fail,pass:i.pass,iou:i.iou.concat(t.IOU([a])),informant:i.informant}):(a=>a.isFail||a.isPass||a.isInquiry?a.answer(i,n.name,c):t.Pass(a))(a)},informant:n=>c({subject:i.subject,iou:i.iou,fail:i.fail,pass:i.pass,informant:n}),inspect:()=>`InquiryF(${i.fail.inspect()} ${i.pass.inspect()} ${i.iou.inspect()}`,swap:()=>c({subject:i.subject,iou:i.iou,fail:t.Fail(i.pass.join()),pass:t.Pass(i.fail.join()),informant:i.informant}),unison:n=>c({subject:i.subject,iou:i.iou,fail:t.Fail(n(i.fail.join())),pass:t.Pass(n(i.pass.join())),informant:i.informant}),map:n=>r(n(i)),ap:n=>n.map(i),chain:n=>n(i),join:()=>i,breakpoint:n=>i.fail.join().length?n(i):c(i),milestone:n=>i.pass.join().length?n(i):c(i),answer:(n,a,s)=>(n.informant([a,c(i)]),c({subject:n.subject,iou:n.iou,fail:n.fail.concat(i.fail),pass:n.pass.concat(i.pass),informant:n.informant})),conclude:(n,a)=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>i.isInquiry?i.join():i).fork(console.error,i=>({subject:i.subject,iou:i.iou,fail:n(i.fail),pass:a(i.pass),informant:i.informant})),cleared:n=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>"isInquiry"in i?i.join():i).fork(console.error,i=>i.fail.isEmpty()?n(i.pass):c(i)),faulted:n=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>"isInquiry"in i?i.join():i).fork(console.error,i=>i.fail.isEmpty()?c(i):n(i.fail)),fork:(n,a)=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>"isInquiry"in i?i.join():i).chain(i=>i.fail.join().length?n(i.fail):a(i.pass)),zip:n=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>"isInquiry"in i?i.join():i).chain(i=>n(i.fail.join().concat(i.pass.join()))),await:()=>o.Future.parallel(1/0,i.iou.join()).map(e(i)).map(i=>"isInquiry"in i?i.join():i).chain(i=>u(i)),isInquiry:!0}),l={subject:r,of:u};n.InquiryF=l}])});
//# sourceMappingURL=inquiry-monad-futures.min.js.map